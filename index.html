{% extends 'base.html' %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card shadow border-0 rounded-3">
      <div class="card-body">
        <h1 class="mb-3">Protect Your Code</h1>
        <p class="text-secondary">Paste your Roblox Lua script and generate a protected URL + ready-to-use loadstring link.</p>

        {% if current_user.is_authenticated %}
        <form id="protectForm" class="mt-3">
          <div class="mb-3">
            <label class="form-label">Your script</label>
            <textarea name="code" id="codeInput" class="form-control" rows="10" placeholder="-- paste your code here" required></textarea>
          </div>
          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">üõ°Ô∏è Protect Code</button>
          </div>
        </form>

        <div id="result" class="alert alert-success mt-4 d-none">
          <h5 class="mb-3">‚úÖ Code Protected!</h5>
          <div class="input-group mb-2">
            <span class="input-group-text">Protected URL</span>
            <input type="url" id="protectedUrl" class="form-control" readonly>
            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard(document.getElementById('protectedUrl').value)">Copy</button>
          </div>
          <div class="input-group">
            <span class="input-group-text">Loadstring</span>
            <input type="text" id="loadstringUrl" class="form-control" readonly>
            <button class="btn btn-outline-secondary" type="button" onclick="copyLoadstring()">Copy</button>
          </div>
        </div>

        {% else %}
          <div class="alert alert-dark border-0">You must <a href="{{ url_for('login') }}">log in</a> or <a href="{{ url_for('signup') }}">sign up</a> to protect code.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
